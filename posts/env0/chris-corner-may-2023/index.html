<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  
    
  <title>Chris&#39; Corner - May 2023 | UltTransformer</title>
  <meta name="author" content="Puppet">
  <meta name="description" content="Note: This is a copy of my env0 post.
Introductionenv0 has released 3 key features this month, directly helping new and existing customers. One of our features has already been covered in a separate blog, the Private provider registry.
Remote state access control - Share state between projects within env0. Private provider registry - Use both public and private providers. Private plugins - Integrate your own privately hosted plugin. Project-level remote backend enforcement - Force env0 remote state on all deployments within a Project.">
  <meta name="keywords" content="blog,developer,personal">

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Chris&#39; Corner - May 2023"/>
<meta name="twitter:description" content="Note: This is a copy of my env0 post.
Introductionenv0 has released 3 key features this month, directly helping new and existing customers. One of our features has already been covered in a separate blog, the Private provider registry.
Remote state access control - Share state between projects within env0. Private provider registry - Use both public and private providers. Private plugins - Integrate your own privately hosted plugin. Project-level remote backend enforcement - Force env0 remote state on all deployments within a Project."/>

  <meta property="og:title" content="Chris&#39; Corner - May 2023" />
<meta property="og:description" content="Note: This is a copy of my env0 post.
Introductionenv0 has released 3 key features this month, directly helping new and existing customers. One of our features has already been covered in a separate blog, the Private provider registry.
Remote state access control - Share state between projects within env0. Private provider registry - Use both public and private providers. Private plugins - Integrate your own privately hosted plugin. Project-level remote backend enforcement - Force env0 remote state on all deployments within a Project." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ulttransformer.github.io/posts/env0/chris-corner-may-2023/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-05-01T00:00:00+00:00" />

  <link rel="stylesheet" href="/css/bootstrap.min.css"  crossorigin="anonymous">
  
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css" rel="stylesheet" type="text/css">

  <link rel="stylesheet" href="/sass/main.css">

  <link rel="stylesheet" href="/zoomjs/zoom.min.css">

  <script src=/js/lazysizes.min.js></script>

  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  

</head>



<body ontouchstart="">
  <nav class="navbar navbar-default navbar-custom navbar-fixed-top ">
  <div class="container-fluid">
    
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://ulttransformer.github.io">UltTransformer</a>
    </div>
    
    <div id="huxblog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          
          <li><a href="/" title="Home">Home</a></li>
          
          <li><a href="/posts/" title="Posts">Posts</a></li>
          
          <li><a href="/about/" title="About">About</a></li>
          

          <li class="search-icon">
            <a href="javascript:void(0)">
              <i class="fa fa-search"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
    
  </div>
  
</nav>
<script>
  
  
  
  var $body = document.body;
  var $toggle = document.querySelector(".navbar-toggle");
  var $navbar = document.querySelector("#huxblog_navbar");
  var $collapse = document.querySelector(".navbar-collapse");

  var __HuxNav__ = {
    close: function () {
      $navbar.className = " ";
      
      setTimeout(function () {
        
        if ($navbar.className.indexOf("in") < 0) {
          $collapse.style.height = "0px";
        }
      }, 400);
    },
    open: function () {
      $collapse.style.height = "auto";
      $navbar.className += " in";
    },
  };

  
  $toggle.addEventListener("click", function (e) {
    if ($navbar.className.indexOf("in") > 0) {
      __HuxNav__.close();
    } else {
      __HuxNav__.open();
    }
  });

  

  document.addEventListener("click", function (e) {
    if (e.target == $toggle) return;
    if (e.target.className == "icon-bar") return;
    __HuxNav__.close();
  });
</script>
  
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div>

  
  


<style type="text/css">
  header.intro-header {
    position: relative;
    background-image: url('/img/blogs.jpeg');
  }
</style>

<header class="intro-header ">

  <div class="header-mask"></div>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <div class="tags">
            
            <a class="tag" href="/tags/env0/" title="env0">env0</a>
            
          </div>
          <h1>Chris&#39; Corner - May 2023</h1>
          <h2 class="subheading">env0</h2>
          <span class="meta">
            Posted by  Chris Noon 
            on Mon, May 1, 2023
          </span>
        </div>
      </div>
    </div>
  </div>
</header>


  


<article>
  <div class="container">
    <div class="row">

      
      <div class="
              col-lg-8 col-lg-offset-2
              col-md-10 col-md-offset-1
              post-container">
        <blockquote>
<p>Note: This is a copy of my <a href="https://www.env0.com/blog/chris-corner-may-2023" target="_blank">env0 post</a>.</p>
</blockquote>
<h3 id="introduction">Introduction<a class="anchorjs-link" href="#introduction"></a></h3><p>env0 has released 3 key features this month, directly helping new and existing customers.  One of our features has already been covered in a separate blog, the <a href="https://www.env0.com/blog/provider-registry" target="_blank">Private provider registry</a>.</p>
<ul>
<li><a href="https://docs.env0.com/changelog/remote-state-access-control" target="_blank">Remote state access control</a> - Share state between projects within env0.</li>
<li><a href="https://docs.env0.com/changelog/private-provider-registry" target="_blank">Private provider registry</a> - Use both public and private providers.</li>
<li><a href="https://docs.env0.com/changelog/private-plugins" target="_blank">Private plugins</a> - Integrate your own privately hosted plugin.</li>
<li><a href="https://docs.env0.com/changelog" target="_blank">Project-level remote backend enforcement</a> - Force env0 remote state on all deployments within a Project.</li>
</ul>
<p>If you want to keep up to date with the features as they are released, follow the <a href="https://docs.env0.com/changelog" target="_blank">changelog</a>.</p>
<p>This month&rsquo;s highlighted feature will be <a href="https://docs.env0.com/changelog/remote-state-access-control" target="_blank">Remote state access control</a>.</p>
<p><a href="https://vimeo.com/827425759" target="_blank">https://vimeo.com/827425759</a></p>
<h3 id="whats-the-problem">What’s the problem?<a class="anchorjs-link" href="#whats-the-problem"></a></h3><p>Many of our customers have asked what is our recommended method of sharing variables and outputs between workspaces/environments.  Terraform has some native methods of achieving this:</p>
<ul>
<li><a href="https://developer.hashicorp.com/terraform/language/state/remote-state-data" target="_blank">Remote backend sharing</a></li>
<li><a href="https://developer.hashicorp.com/terraform/language/data-sources" target="_blank">Data Sources</a></li>
</ul>
<p>That said, both options can either be a security risk or convoluted to achieve in code.</p>
<h3 id="how-does-env0-solve-the-problem">How does env0 solve the problem?<a class="anchorjs-link" href="#how-does-env0-solve-the-problem"></a></h3><p>env0’s remote state access control features allows for state sharing between workspaces/environments at the click of a button.  The only caveat of this feature is you use env0’s remote state.</p>
<p>The benefits of this solution is that env0 will look after your remote state in a secure bucket and the state outputs are only shared between chosen environments.</p>
<p>You can read more about env0 remote backend here:</p>
<p><a href="https://docs.env0.com/docs/remote-backend" target="_blank">https://docs.env0.com/docs/remote-backend</a></p>
<p>The documentation for the remote state access control can be found here:</p>
<p><a href="https://docs.env0.com/docs/remote-state-data-source" target="_blank">https://docs.env0.com/docs/remote-state-data-source</a></p>
<h3 id="new-feature">New Feature<a class="anchorjs-link" href="#new-feature"></a></h3><p>In this example I have pre-created an AWS VPC and we are going to deploy an EC2 instance using some outputs from the VPC.</p>
<p>It’s important to note that the VPC has outputs configured.  In this instance the VPC ID and Subnet ID’s.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>output &#34;vpc_1&#34; {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span> value = aws_vpc.vpc_1.id
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>output &#34;subnet_1&#34; {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span> value = aws_subnet.subnet_1.id
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>}
</span></span></code></pre></div><p>Let’s navigate to the (sub-)project that hosts the VPC environment and drop into it.</p>
<p><figure>
  <a class="paragraph-image">
    <img data-src="/img/env0/chris-corner-may-2023/project-environment.png" data-action="zoom" alt="Project Environments"  class="lazyload">
  </a>
  
</figure></p>
<p>Once in the VPC environment, check that the VPC outputs are correct.</p>
<p><figure>
  <a class="paragraph-image">
    <img data-src="/img/env0/chris-corner-may-2023/outputs.png" data-action="zoom" alt="Outputs"  class="lazyload">
  </a>
  
</figure></p>
<p>Then navigate to the environment settings and change the remote state access setting to ensure the outputs are readable by the desired project(s).  In my example I will be deploying an EC2 instance in the EC2 sub-project.</p>
<p><figure>
  <a class="paragraph-image">
    <img data-src="/img/env0/chris-corner-may-2023/sharing.png" data-action="zoom" alt="Sharing"  class="lazyload">
  </a>
  
</figure></p>
<p>Now that the remote state is exposed to the desired projects, we can add code to the EC2 instances to first read the state from the VPC workspace and then port the desired outputs into the EC2 environment.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>data &#34;terraform_remote_state&#34; &#34;example&#34; {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span> backend = &#34;remote&#34;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span> config = {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>   hostname     = &#34;backend.api.env0.com&#34;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>   organization = &#34;[ORGANIZATION_ID]&#34;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>   workspaces = {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>     name = &#34;[WORKSPACE_NAME]&#34;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>   }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span> }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>data &#34;aws_vpc&#34; &#34;vpc_1&#34; {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span> id = data.terraform_remote_state.vpc.outputs.vpc_1
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>}
</span></span></code></pre></div><p>Once the outputs have been read, the EC2 configuration can us the dynamic values (like VPC and Subnet IDs) in code for speed and ease of deployment.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>name   = var.security-group-name
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span> vpc_id = data.aws_vpc.vpc_1.id
</span></span></code></pre></div><p>Additional Resources:</p>
<ul>
<li><a href="https://docs.env0.com/docs/remote-backend" target="_blank">env0 remote state</a></li>
<li><a href="https://docs.env0.com/docs/remote-state-data-source" target="_blank">env0 data resource</a></li>
<li><a href="https://www.env0.com/blog/share-outputs-between-iac-stacks" target="_blank">Import variable plugin</a></li>
</ul>
<p>We hope you found this blog interesting and the feature useful.</p>
<p>Should you want to speak to one of the team please reach out to us for a <a href="https://www.env0.com/demo-request" target="_blank">demo</a> or message the author, Chris on <a href="https://www.linkedin.com/in/chrisgrahamnoon/" target="_blank">LinkedIn</a> or <a href="https://twitter.com/UltTransformer" target="_blank">Twitter</a>.</p>


        <hr style="visibility: hidden;" />
        <ul class="pager">
          
          <li class="previous">
            <a href="/posts/env0/chris-corner-april-2023/" data-toggle="tooltip" data-placement="top" title="Chris&#39; Corner - April 2023">
              Previous<br>
              <span>Chris&#39; Corner - April 2023</span>
            </a>
          </li>
          
          
          <li class="next">
            <a href="/posts/cilium/k3s-with-cilium-install/" data-toggle="tooltip" data-placement="top" title="K3s with Cilium Install">
              Next<br>
              <span>K3s with Cilium Install</span>
            </a>
          </li>
          
        </ul>
        <hr style="visibility: hidden;" />

        
        






      </div>

      
      
      
      
      <div class="
              col-lg-8 col-lg-offset-2
              col-md-10 col-md-offset-1
              sidebar-container">

        
        
        <section>
  
  
  <hr class="hidden-sm hidden-xs">
  
  <h5>FEATURED TAGS</h5>
  <div class="tags">
    
    <a href="/tags/cilium/">Cilium</a>
    
    <a href="/tags/env0/">env0</a>
    
    <a href="/tags/nsx/">NSX</a>
    
    <a href="/tags/vcdx/">VCDX</a>
    
  </div>
</section>

        
        

      </div>
    </div>
  </div>
</article>



  
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        
        <ul class="list-inline text-center">

<li>
  <a href="https://github.com/UltTransformer" target="_blank">
    <span class="fa-stack fa-lg">
      <i class="fa fa-circle fa-stack-2x"></i>
      <i class="fab fa-github fa-stack-1x fa-inverse"></i>
    </span>
  </a>
</li>

<li>
  <a href="https://linkedin.com/in/chrisgrahamnoon" target="_blank">
    <span class="fa-stack fa-lg">
      <i class="fa fa-circle fa-stack-2x"></i>
      <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
    </span>
  </a>
</li>

<li>
  <a href="https://twitter.com/UltTransformer" target="_blank">
    <span class="fa-stack fa-lg">
      <i class="fa fa-circle fa-stack-2x"></i>
      <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
    </span>
  </a>
</li>


<li>
  <a href="/index.xml" target="_blank">
    <span class="fa-stack fa-lg">
      <i class="fa fa-circle fa-stack-2x"></i>
      <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
    </span>
  </a>
</li></ul>

        <p class="copyright text-muted">
          Copyright &copy; UltTransformer 2023  
          <br>
          Powered by <a href="https://gohugo.io">Hugo</a>
        </p>
      </div>
    </div>
  </div>
</footer>

<script src=/js/jquery.min.js></script>
<script src=/js/bootstrap.min.js crossorigin="anonymous"></script>



<script src="/js/hux-blog.min.c4ea77041cd3edbfc8b2622cd887a9a5d8760a4162d14489e36d2a3fa4c90172.js"></script>


<script src=/js/simple-jekyll-search.min.js></script>


<script src="/js/search.min.53bce5da475b4d362500e5ce5dddfa22e20e1b9018777411d2020b4b839c9310.js"></script>













<script src="/zoomjs/zoom.min.js"></script>

</body>

</html>